!function(){"use strict";timeTrackingApp.controller("WebcamCtrl",["$scope","$state","$mdToast","$mdDialog","webcamService","faceRecognitionService","userModel","timeTrackingService","localStorageService",function(e,n,t,o,a,c,i,r,l){e.status=i.isCurrentUserClockIn()?"out":"in",e.username=i.getUserName();var s=l.get("lastStatus");if(null!==s&&s.length>0){var u=new Date(s[0].start);e.lastClockIn="Your last Clock In time: "+u.toString("dddd, MMMM d, yyyy hh:mm tt")}e.channel=a.webcam.channel,e.exitWebcam=function(){n.go("pinLogin")},e.onSuccess=function(){a.webcam.onSuccess(),e.showButton=!0,e.$apply(function(){e.showButton=!0})},e.onStream=a.webcam.onStream,e.makeSnapshot=a.webcam.makeSnapshot,e.onError=function(){e.$apply(),a.webcam.onError(),t.show(t.simple().content("Please reboot device!").theme("error-toast").hideDelay(8e3))},a.webcam.showDialog=function(e){function t(e,n){e.dialog_status=i.isCurrentUserClockIn()?"out":"in",e.photo=n,e.cancel=function(){o.cancel()},e.answer=function(e){o.hide(e)},e.upload=function(){if(!i.hasGoldenPhoto())return c.uploadGoldenPicture(n),o.hide(!0),!0;c.getRecognitionResult(n).then(function(e){console.log(e),o.hide(!0),r.punchTime(e)},function(e){console.log(e),o.hide(!1)})}}t.$inject=["$scope","image"],o.show({controller:t,templateUrl:"app/components/templates/confirmDialog.tmpl.html",parent:angular.element(document.body),clickOutsideToClose:!1,fullscreen:!0,locals:{image:e}}).then(function(e){if(!0===e){var t="";t=i.isCurrentUserClockIn()?"Thank you! "+i.getCurrentUserFisrtName()+"ï¼Œyou are Clock Out!":"Thank you! "+i.getCurrentUserFisrtName()+", you are Clock In!",o.show(o.alert().clickOutsideToClose(!0).title("Confirm Message").textContent(t).ariaLabel(t).ok("Okay!")).finally(function(){a.webcam.turnOff(),n.go("pinLogin")})}},function(){})}}])}();