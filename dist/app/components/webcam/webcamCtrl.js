!function(){"use strict";timeTrackingApp.controller("WebcamCtrl",["$scope","$state","$mdToast","$mdDialog","webcamService","faceRecognitionService","userModel","timeTrackingService","localStorageService",function(e,t,n,o,i,c,a,r,s){e.status=a.isCurrentUserClockIn()?"out":"in",e.username=a.getUserName();var l=s.get("lastStatus");if(null!==l&&l.length>0){var u=new Date(l[0].start);e.lastClockIn="Your last Clock In time: "+u.toString("dddd, MMMM d, yyyy hh:mm tt")}e.channel=i.webcam.channel,e.exitWebcam=function(){t.go("pinLogin")},e.onSuccess=function(){i.webcam.onSuccess(),e.showButton=!0,e.$apply(function(){e.showButton=!0})},e.onStream=i.webcam.onStream,e.makeSnapshot=i.webcam.makeSnapshot,e.onError=function(){e.$apply(),i.webcam.onError(),n.show(n.simple().content("Please reboot device!").theme("error-toast").hideDelay(8e3))},i.webcam.showDialog=function(e){function s(e,t){e.dialog_status=a.isCurrentUserClockIn()?"out":"in",e.photo=t,e.cancel=function(){o.cancel()},e.answer=function(e){o.hide(e)},e.upload=function(){if(!a.hasGoldenPhoto())return c.uploadGoldenPicture(t),o.hide(!0),!0;c.getRecognitionResult(t).then(function(e){console.log(e),o.hide(!0),r.punchTime(e)},function(e){console.log(e),o.hide(!1)})}}s.$inject=["$scope","image"],o.show({controller:s,templateUrl:"app/components/templates/confirmDialog.tmpl.html",parent:angular.element(document.body),clickOutsideToClose:!1,fullscreen:!0,locals:{image:e}}).then(function(e){!0===e&&(a.isCurrentUserClockIn()?n.show(n.simple().textContent("Thank you! "+a.getCurrentUserFisrtName()+"ï¼Œyou are Clock Out!").position("right")):n.show(n.simple().textContent("Thank you! "+a.getCurrentUserFisrtName()+", you are Clock In!").position("right")),setTimeout(function(){i.webcam.turnOff(),t.go("pinLogin")},1500))},function(){})}}])}();