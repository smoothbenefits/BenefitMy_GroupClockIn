timeTrackingApp.factory("AuthService",["localStorageService","$http","$q","ENV_VARS","companyModel",function(e,n,o,r,t){function a(e){if(!angular.isObject(e))return null===e?"":e.toString();var n=[];for(var o in e)if(e.hasOwnProperty(o)){var r=e[o];n.push(encodeURIComponent(o)+"="+encodeURIComponent(null===r?"":r))}return n.join("&").replace(/%20/g,"+")}return{login:function(i,s){var l=o.defer();e.set("username",i),e.set("password",s);var u=a({email:i,password:s});return n({url:r.BASEURL+"user/auth/",method:"POST",data:u,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(n){console.log(n),e.set("isLogin",!0),t.setCompanyProfile(n.data),l.resolve(n)},function(n){l.reject(n),e.set("isLogin",!1),console.log(n)}),l.promise},reAuth:function(){var n=e.get("username"),o=e.get("password");return console.log(n+o),this.login(n,o)},isLogin:function(){var n=e.get("isLogin"),o=t.getCompanyID();return!(null===n||!1===n||null===o)}}}]);